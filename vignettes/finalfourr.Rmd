---
title: "Finalfourr Vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{test}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(finalfourr)
```

Package can be found at [https://github.com/ZayneHMaughan/finalfourr](https://github.com/ZayneHMaughan/finalfourr)


# Introduction

This vignette describes the main functionality of this package which is to 
predict what team make it to the Sweet Sixteen for a given year of data. The original
intent was to  predict the Final Four. However, after trail and error no model 
was close in it's predictive power. This same iteration was done for the Elite 
Eight. After moving on, the Sweet 16 proved to be more feasible and have a strong
predictive capability. Though the predictions are good, this is not the only 
functionality of this model.

## Installation Instructions:

In order to install the finalfourr package you must first install the cbbdata
package then install finalfourr:

```{r, eval=FALSE}
devtools::install_github("andreweatherman/cbbdata")
devtools::install_github("ZayneHMaughan/cbbdata")
```

---

## Predicting Sweet 16

### `predict_s16_teams()`

This returns a table with the teams that are predicted to make it to the sweet 
16. For this example, we will be using the 2020 season to make a prediction as to
what teams would have made it if their season was not ended before the tournament
due to Covid. 

```{r predictions-example}
predict_s16_teams(2020)
```


This vignette also demonstrates how to use several functions from the package to 
explore NCAA basketball team data, including:

- Comparing two teams (`compare_teams()` and `plot_compare_teams()`)
- Listing bracket teams for a given year (`get_bracket_teams()`)
- Getting team lists by conference (`get_teams_by_conf()`)
- Searching for teams by keyword (`search_team()`)
- Simulating a matchup between two teams (`simulate_matchup()`)
- Flipping a coin between two teams (`flip_a_coin()`)

All functions assume the presence of a dataset like `cbb_data`, containing 
columns such as `year`, `team`, `CONF`, and `POSTSEASON`.

--- 


## Comparing Two Teams

### `compare_teams()`

Returns offensive and defensive metrics for two teams in a given year:

- `ftr`: Free throw rate  
- `two_pt_pct`: 2-point percentage  
- `three_pt_pct`: 3-point percentage  
- `def_ftr.y`: Opponent free throw rate  
- `def_two_pt_pct`: Opponent 2-point percentage  
- `def_three_pt_pct`: Opponent 3-point percentage

```{r compare-example}
comparison <- compare_teams(2021, "Gonzaga", "Baylor")
comparison
```

### `plot_compare_teams()`

Visualizes the comparison in a bar chart.

```{r plot-example, fig.width=8, fig.height=5}
plot_compare_teams(comparison)
```

---

## Getting Bracket Teams

### `get_bracket_teams()`

Returns all teams that made the NCAA tournament in a given year. Teams are 
identified via the `POSTSEASON` column.

```{r get-bracket-example}
bracket_teams <- get_bracket_teams(2023)
head(bracket_teams)
```

**Note**: Any `POSTSEASON` value not equal to `"0"`, `"N/A"`, or `NA` is 
considered bracket-eligible.

---

## Getting Teams by Conference

### `get_teams_by_conf()`

Returns a named list of conferences and the teams that belonged to each in a
given year.

```{r get-conf-example}
conf_teams <- get_teams_by_conf(2018)
names(conf_teams) # List of conference names
head(conf_teams$`Big Ten`) # Teams in the Big Ten
```

---

### Searching for Teams by Keyword using `search_team()`

`search_team()` allows you to quickly find teams whose names contain a specific
keyword. This is useful when you're working with this large dataset and want to 
filter down to teams of interest and available years of data.

For example, we can see all teams with the keyword `utah`:

```{r}
search_team("utah", include_years = TRUE)
```

---

### Simulating a Matchup Between Two Teams using `simulate_matchup()`

`simulate_matchup()` allows you to simulate head-to-head matchups between two 
teams in a given season. This can help estimate win probabilities based on 
adjusted offensive, defensive, and tempo metrics.

For example, here we simulate 1000 games between Utah and Baylor in the 2015 
season:

```{r}
set.seed(387)
simulate_matchup("Utah", "Baylor", 2015)
```

---

### Flipping a Coin Between Two Teams using `flip_a_coin()`

`flip_a_coin()` is a whimsical tool that stochastically selects a winner 
between two teams—essentially a virtual coin flip. It provides no analytical 
value but can be a fun way to break ties or help decide between picking two 
teams.

For example, here we flip a coin between BYU and Utah:

```{r, results='hold'}
set.seed(348)
flip_a_coin("BYU", "Utah")
```

---

## Notes

- These functions rely on consistent naming in the dataset: columns like `year`,
`team`, `CONF`, and `POSTSEASON` must be present.
- Use validation helpers 
(e.g., `validate_inputs()`, `validate_bracket_inputs()`) to ensure robust 
function calls.

## Session Info

```{r session-info}
sessionInfo()
```

---

### Get All of the Team Stats Using `filter_team()`

`filter_team()` allows you to pull of the available stats for a team during a 
a given season. 

```{r}
filter_team("N.C. State", season = 2016)
```

## Notes
- If season is Null filter team will return all of the teams stats for all 
available seasons. 

---

### Plot the Power Ranking Using `power_plot()`

`plot_power()` allows you to visualize how a specific college basketball team's 
power ranking—measured by the barthag metric—has evolved over time. This plot is especially useful for identifying trends, such as periods of sustained success 
or decline, and  comparing team trajectories across seasons. The only input to 
the function is  the team name (as a string), and it returns a base R plot 
showing the team's power rating from 2013 to the most recent season available 
in the dataset.

```{r ,fig.width=8, fig.height=5}
plot_power("Utah St.")
```
